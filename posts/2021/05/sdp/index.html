

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Equivalent formulations of semidefinite programs using linear matrix inequality and trace - Homepage</title>








  <meta property="article:published_time" content="2021-05-02T00:00:00+00:00">



  <link rel="canonical" href="https://ljchen.ca/posts/2021/05/sdp/">





  

  






  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Liangjie (Jeffrey) Chen",
      "url" : "https://ljchen.ca",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->

<!-- Open Graph protocol data (https://ogp.me/), used by social media -->
<meta property="og:locale" content="en-CA">
<meta property="og:site_name" content="Homepage"> 
<meta property="og:title" content="Equivalent formulations of semidefinite programs using linear matrix inequality and trace">

  <meta property="og:type" content="article">


  <meta property="og:description" name="description" content="A semidefinite program written using the linear matrix inequality can be equivalently written using the trace of a matrix.">


  <meta property="og:url" content="https://ljchen.ca/posts/2021/05/sdp/">





<!-- end Open Graph protocol -->

<link href="https://ljchen.ca/feed.xml" type="application/atom+xml" rel="alternate" title="Homepage Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://ljchen.ca/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<!-- favicon from https://commons.wikimedia.org/wiki/File:OOjs_UI_icon_academic-progressive.svg -->
<link rel="apple-touch-icon" sizes="180x180" href="https://ljchen.ca/images/apple-touch-icon-180x180.png"/>
<link rel="icon" type="image/svg+xml" href="https://ljchen.ca/images/favicon.svg"/>
<link rel="icon" type="image/png" href="https://ljchen.ca/images/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="https://ljchen.ca/images/favicon-192x192.png" sizes="192x192"/>
<link rel="manifest" href="https://ljchen.ca/images/manifest.json"/>
<link rel="icon" href="/images/favicon.ico"/>
<meta name="theme-color" content="#ffffff"/>
<link rel="stylesheet" href="https://ljchen.ca/assets/css/academicons.css"/>


<!-- Support for MatJax -->
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- end custom head snippets -->

    <script>
window.MathJax = {
  tex: {
    macros: {
      inR: "\\in \\mathbb{R}",
      inC: "\\in \\mathbb{C}",
      inZ: "\\in \\mathbb{Z}",
      inN: "\\in \\mathbb{N}",
      inQ: "\\in \\mathbb{Q}",
      inF: "\\in \\mathbb{F}",
      inS: "\\in \\mathbb{S}",
      j: "\\boldsymbol{\\mathrm{j}}",
      e: "\\boldsymbol{\\mathrm{e}}",
      re: "\\mathrm{Re}",
      im: "\\mathrm{Im}",
      det: "\\mathrm{det}",
      minimize: ["\\underset{#1}{\\mathrm{minimize}}", 1],
      maximize: ["\\underset{#1}{\\mathrm{maximize}}", 1],
      st: "\\mathrm{subject\\ to}",
      trace: "\\mathrm{tr}",
      diag: "\\mathrm{diag}",
      goesto: "\\rightarrow",
      implies: "\\Rightarrow",
      define: "\\triangleq",
      transpose: ["{#1}^{\\mathsf{T}}", 1],
      pinv: ["{#1}^{\\dagger}", 1],
      zero: "\\mathbf{0}",
      one: "\\mathbf{1}"
    },
    packages: ['base', 'ams'],
    tags: 'ams'
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg persist"><a href="https://ljchen.ca/">Homepage</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://ljchen.ca/research/">Research</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://ljchen.ca/posts/">Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://ljchen.ca/misc/">Misc</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://ljchen.ca/files/cv.pdf">CV</a></li>
          
          <li id="theme-toggle" class="masthead__menu-item persist tail">
            <a><i id="theme-icon" class="fa-solid fa-sun" aria-hidden="true" title="toggle theme"></i></a>
          </li>
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="https://ljchen.ca/images/profile.jpg" class="author__avatar" alt="Liangjie (Jeffrey) Chen">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Liangjie (Jeffrey) Chen</h3>
    
    <p class="author__bio">data-driven control & optimization</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      <!-- Font Awesome icons / Biographic information  -->
      
        <li class="author__desktop"><i class="fas fa-fw fa-location-dot icon-pad-right" aria-hidden="true"></i>Canada</li>
      
      
        <li class="author__desktop"><i class="fas fa-fw fa-building-columns icon-pad-right" aria-hidden="true"></i>University of Toronto</li>
      
      
      

      <!-- Font Awesome and Academicons icons / Academic websites -->
      
            
      
        <li><a href="https://scholar.google.com/citations?user=juDFQPEAAAAJ&hl=en"><i class="ai ai-google-scholar ai-fw icon-pad-right"></i>Google Scholar</a></li>
      
      
      
      
                              
      
      

      <!-- Font Awesome icons / Repositories and software development -->
      
            
            
      
        <li><a href="https://github.com/jchen975"><i class="fab fa-fw fa-github icon-pad-right" aria-hidden="true"></i>GitHub</a></li>
      
            
            

      <!-- Font Awesome icons / Social media -->
      
      
            
      
                  
                  
      
            
            
      
        <li><a href="https://www.linkedin.com/in/jchen975"><i class="fab fa-fw fa-linkedin icon-pad-right" aria-hidden="true"></i>LinkedIn</a></li>
            
      
            
                  
            
      
            
            
      
              
      
                      
      
      
            
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Equivalent formulations of semidefinite programs using linear matrix inequality and trace">
    <meta itemprop="description" content="A semidefinite program written using the linear matrix inequality can be equivalently written using the trace of a matrix.">
    <meta itemprop="datePublished" content="May 02, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Equivalent formulations of semidefinite programs using linear matrix inequality and trace
</h1>
          
            <p class="page__meta"><i class="fa fa-clock" aria-hidden="true"></i> 


  
	  6 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2021-05-02T00:00:00+00:00">May 02, 2021</time></p>
            
        </header>
      

      <section class="page__content" itemprop="text">
        <p>A semidefinite program written using the linear matrix inequality can be equivalently written using the trace of a matrix.</p>

<p><em>Acknowledgement: the content of this post originates from a homework question in Prof. Stark Draperâ€™s course, ECE1505 Convex Optimization, at the University of Toronto.</em></p>

<h2 id="semidefinite-program-and-linear-matrix-inequality">Semidefinite program and linear matrix inequality</h2>
<p>Semidefinite programs (SDPs) are a specific type of <em>conic form programs</em>, which is a subclass of convex optimization problems with respect to the <a href="https://en.wikipedia.org/wiki/Loewner_order">Lowener order</a>, that is, the cone of (symmetric) positive semidefinite matrices denoted by \(\mathbb{S}_{+}^{n}\). SDPs are typically formulated as</p>

\[\begin{equation}\label{eq:sdp-lmi} 
\begin{array}{cl}
    \minimize{x \in \mathbb{R}^n} &amp; \transpose{c}x  \\ 
    \st &amp; F_0 + x_1F_1 + \cdots + x_n F_n \preceq \zero \\
    &amp; Gx = h
\end{array}  
\end{equation}\]

<p>where \(c \inR^n, G \inR^{p\times n}, h \inR^p\), and each \(F_i\) is an \(m \times m\) real symmetric matrix, denoted by \(F_i \inS^m\). The inequality constraint is known as a <em>linear matrix inequality</em> (LMI), which is a generalized inequality with respect to the partial order defined by the convex cone of symmetric positive definite matrices. In addition, while the decision variable in the SDP above is the vector \(x \inR^n\), they can often appear as matrices (not even necessarily symmetric matrices) in an SDP. For example, for \(i \in \{1, \dots, N\}\), let \(A_i \inR^{n \times n}, B_i \inR^{n \times n}, C_i \inR^{n \times m}\) be constant coefficient matrices, and let \(X \inS^n_{++}\) and \(Y \inR^{m \times n}\) be unknown decision variables, then</p>

\[F(X,Y) \define F_0 + \sum_{i = 1}^N A_i X B_i + \transpose{B}_i X \transpose{A}_i + C_i Y + \transpose{Y} \transpose{C}_i \succeq \zero\]

<p>is a perfectly valid LMI in \(X\) and \(Y\). This form of LMIs often appears in SDPs used in, e.g., systems control theory.</p>

<h2 id="equivalent-sdp-formulation-using-trace-of-a-square-matrix">Equivalent SDP formulation using trace of a square matrix</h2>
<p>The goal of this post is to show that, another SDP formulation, now written with the trace of a matrix, denoted by \(\trace(\cdot)\),</p>

\[\begin{equation}\label{eq:sdp-trace}
\begin{array}{cl}
    \minimize{X \in \mathbb{S}^{\bullet}_+} &amp; \trace(CX)  \\ 
    \st &amp; \trace(A_k X) = b_k, \quad k \in \{1, \dots, q\}\\
    &amp; X \succeq \zero
\end{array} 
\end{equation}\]

<p>is in fact equivalent to \eqref{eq:sdp-lmi}, and we show how to establish this equivalence. We left the dimension of the new variable \(X\) vague on purpose for now, as the construction below will clarify it. Before we do this, letâ€™s recall that the <em>trace</em> of a square matrix is defined as the sum of its diagonal elements, and is connected to the standard Frobenius inner product on \(\mathbb{R}^{m \times n}\) via</p>

\[\trace(\transpose{X}Y) = \trace(X\transpose{Y}) = \langle X, Y \rangle = \sum_{i=1}^{m}\sum_{j=1}^n X_{ij}Y_{ij}.\]

<p>There are many additional properties of the matrix trace and its generalization that we will not discuss here, and we include some relevant references at the end of this post.</p>

<p>We are now ready to convert \eqref{eq:sdp-lmi} into \eqref{eq:sdp-trace}. First, from the left-hand side of the LMI in \eqref{eq:sdp-lmi}, define a slack variable from the left-hand side of the LMI in \eqref{eq:sdp-lmi}:</p>

\[\label{eq:X-tilde}
\tilde{X} \define -F_0 - \sum_{i=1}^n x_i F_i.\]

<p>We further decompose the decision variable \(x\) element-wise by its nonnegative part and its nonpositive part, i.e., \(x = x^+ - x^-\), in which both \(x^+\) and \(x^-\) are non-negative element-wise. (Of course, such decomposition is not unique, and we just pick one). We also denote the diagonal matrix formed by placing the elements of a vector \(v\) on its main diagonal as \(\diag(v)\). We claim that the block diagonal matrix</p>

\[X \define \begin{bmatrix}
    -\tilde{X} &amp; \\
    &amp; \diag(x^+) \\
    &amp; &amp; \diag(x^-)
\end{bmatrix} \inR^{(m+2n) \times (m+2n)}\]

<p>is exactly the decision variable in \eqref{eq:sdp-trace}. As a sanity check, since \(F(x) \preceq \zero\) in \eqref{eq:sdp-lmi}, the new decision variable $X$ above is positive semidefinite, and should be a sparse matrix provided that \(m\) is not significantly larger than \(n\). 
Analogous to the decomposition of \(x\), we can decompose the cost coefficient \(c\) in \eqref{eq:sdp-lmi} as \(c = c^+ - c^-\), in which both \(c^+\) and \(c^-\) are non-negative element-wise, and construct the diagonal matrix</p>

\[C \define \begin{bmatrix}
    \zero_{m\times m} &amp; \\
    &amp; \diag(c^+) \\
    &amp; &amp; \diag(c^-)
\end{bmatrix} \inR^{(m+2n) \times (m+2n)}\]

<p>which satisfies \(\trace(CX) = \transpose{c}x\). We can now compare against \eqref{eq:sdp-lmi}, and see that we need to handle the \(q\) equality constraints in \eqref{eq:sdp-trace}, which has two sources. The first one is due to the definition of the slack variable \(\tilde{X}\) in \eqref{eq:X-tilde}, which must be satisfied element-wise. Thus, given the coefficient matrices \(F_i \inS^{m}\), we need to introduce (at most) \(m(m+1)/2\) equality constraints as follows: define the constant matrices</p>

\[\label{eq:F-tilde}
\tilde{F}_{j\ell} \define \begin{bmatrix}
    \Delta_{\ell j} &amp; \\
    &amp; \diag(F_{i,j \ell}) \\
    &amp; &amp; -\diag(F_{i,j \ell}) 
\end{bmatrix} \inR^{(m+2n)\times (m+2n)}\]

<p>where \(\Delta_{\ell j} \inR^{m \times m}\) is the indicator matrix with \(1\) at the \(\ell, j\)-th element and zero everywhere else, and</p>

\[\diag(F_{i,j \ell}) \define \begin{bmatrix} 
        (F_1)_{j\ell} &amp; \\
        &amp; (F_2)_{j\ell} &amp; \\
        &amp; &amp; \ddots &amp; \\
        &amp; &amp; &amp; (F_n)_{j\ell} &amp; \\
    \end{bmatrix} \inR^{n \times n}\]

<p>is a diagonal matrix with the \(j,\ell\)-th elements of matrices \(F_1, \dots, F_n\) on its main diagonal. Thus, we can verify that</p>

\[\begin{align}
    \trace(\tilde{F}_{j\ell} X) &amp;= \trace(\Delta_{\ell j} \tilde{X}) + \sum_{i=1}^n x_i^+ (F_i)_{j\ell} - \sum_{i=1}^n x_i^- (F_i)_{ij} \nonumber \\
                        &amp;= \tilde{X}_{j\ell} + \sum_{i=1}^n(x_i^+  - x_i^-) (F_i)_{j\ell} \nonumber \\
                        &amp;= -(F_0)_{j\ell} - \sum_{i=1}^n x\_i (F_i)_{j\ell} +  \sum_{i=1}^n x\_i (F_i)_{j\ell} \nonumber \\
                        &amp;= -(F_0)_{j\ell}  \label{eq:eq-constraint-lmi}
\end{align}\]

<p>There are a total of \(m(m+1)/2\) constraints like \eqref{eq:eq-constraint-lmi}, and they form the first part of the equality trace constraints in \eqref{eq:sdp-trace}. The second and the last part comes from \(Gx = h\) in \eqref{eq:sdp-lmi}, which can be transformed by constructing</p>

\[\label{eq:G-tilde}
    \tilde{G}_{i} \define \begin{bmatrix}
        \zero_{m \times m} &amp; \\
        &amp; \diag(\transpose{\e}_i G) \\
        &amp; &amp; -\diag(\transpose{\e}_i G) 
    \end{bmatrix} \inR^{(m+2n)\times (m+2n)}\]

<p>in which \(\transpose{\e}_i G \inR^n\) selects the \(i\)-th row of \(G\). For \(i \in \{1, \dots, p\}\), \(\transpose{\e}_i G x = h_i\), so \(Gx = h\) in \eqref{eq:sdp-lmi} is equivalent to the \(p\) trace constraints</p>

\[\tilde{G}_i X = h_i\]

<p>Thus, from \eqref{eq:sdp-trace}, we have a total of</p>

\[q = \frac{m(m+1)}{2} + p\]

<p>trace equality constraints, and the new coefficient matrices \(A_k\) correspond to \(\tilde{F}_{j\ell}\) and \(\tilde{G}_i\) constructed in \eqref{eq:F-tilde} and \eqref{eq:G-tilde}, respectively, while the coefficients \(b_k\) correspond to \(-(F_0)_{j\ell}\) and \(h_i\), respectively.</p>

<h2 id="further-readings-and-references">Further readings and references</h2>
<ol>
  <li>General introduction and basic examples of SDPs: Chapter 4.6.2 of <a href="https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf">Convex Optimization</a></li>
  <li><a href="https://doi.org/10.1137/1038003">SIAM survey</a> of SDPs and numerical solution methods</li>
  <li>LMIs in systems and control theory <a href="https://web.stanford.edu/~boyd/lmibook/lmibook.pdf">book</a></li>
  <li>Further trace properties and generalizations: Chapter 8.D of <a href="https://linear.axler.net/LADR4e.pdf">Linear Algebra Done Right</a></li>
</ol>

<p><em>Last updated: 2025-07-21 17:38 EST</em></p>


        

        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://ljchen.ca/tags/#coursework" class="page__taxonomy-item" rel="tag">coursework</a><span class="sep">, </span>
    
      
      
      <a href="https://ljchen.ca/tags/#optimization" class="page__taxonomy-item" rel="tag">optimization</a>
    
    </span>
  </p>




      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://bsky.app/intent/compose?text=https://ljchen.ca/posts/2021/05/sdp/" class="btn btn--bluesky" title="Share on Bluesky"><i class="fab fa-bluesky" aria-hidden="true"></i><span> Bluesky</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://ljchen.ca/posts/2021/05/sdp/" class="btn btn--facebook" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ljchen.ca/posts/2021/05/sdp/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>

  <a href="https://x.com/intent/post?text=https://ljchen.ca/posts/2021/05/sdp/" class="btn btn--x" title="Share on X"><i class="fab fa-x-twitter" aria-hidden="true"></i><span> X (formerly Twitter)</span></a>
</section>


      


    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<!-- end custom footer snippets -->

        


<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="http://github.com/jchen975"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="https://ljchen.ca/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">
  &copy; 2025 Liangjie (Jeffrey) Chen, Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.<br />
  Site last updated 2025-07-21
</div>

      </footer>
    </div>

    <script src="https://ljchen.ca/assets/js/main.min.js"></script>








  </body>
</html>

